%    Copyright (C) 2002 Aladdin Enterprises.  All rights reserved.
% 
%  This file is part of GNU ghostscript
%
%  GNU ghostscript is free software; you can redistribute it and/or modify it under
%  the terms of the GNU General Public License as published by the Free Software
%  Foundation; either version 2, or (at your option) any later version.
%
%  GNU ghostscript is distributed in the hope that it will be useful, but WITHOUT
%  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS
%  FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
%
%  You should have received a copy of the GNU General Public License along with
%  ghostscript; see the file COPYING. If not, write to the Free Software Foundation,
%  Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
%
% $Id: gs_devpxl.ps,v 1.4 2007/05/07 11:22:07 Arabidopsis Exp $
% DevicePixel color space method dictionaries.

%
% This file implements the DevicePixel color space. See gs_cspace.ps
% for information.
%
% The DevicePixel color space includes a single parameter, the bit
% depth of the device color representation. Color is expressed as
% single integers in an opaque, device-specific format.
%

% verify that the DevicePixel color space is supported
/.setdevicepixelspace where
  { pop }
  { currentfile closefile }
ifelse


.currentglobal true .setglobal

.cspace_util begin


colorspacedict
/DevicePixel
  mark
    /cs_potential_indexed_base true
    /cs_potential_pattern_base true
    /cs_potential_alternate true
    /cs_potential_icc_alternate true
    /cs_get_ncomps //ncomps_1
    /cs_get_range { [ exch 1 get 1 exch bitshift 1 sub ] } bind
    /cs_get_default_color { pop 0 } bind    % no good default
    /cs_get_currentgray //no_currentgray
    /cs_get_currentrgb //no_currentrgb
    /cs_get_currentcmyk //no_currentcmyk

    /cs_validate
      {
        //check_array exec
        dup 1 get dup type /integertype ne
          //setcspace_typecheck
        if
        dup 0 lt
          //setcspace_rangecheck
        if
        31 gt   % 31 bits is an implementation limit
          { /setcolorspace .systemvar /limitcheck signalerror }
        if
      }
    bind

    /cs_substitute //dup_1
    /cs_prepare {}
    /cs_install { .setdevicepixelspace } bind
    /cs_prepare_color //validate_1
    /cs_complete_setcolor //pop_1
  .dicttomark
put

end     % .cspace_util
.setglobal
